package be.bastien.DAO;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

import be.bastien.metier.Categorie;

public class DAOCategorie extends DAO<Categorie> {
	public DAOCategorie(Connection conn){
		super(conn);
	}
	
	public boolean create(Categorie categorie) {
		return false;
	}
	
	public boolean delete(Categorie categorie) {
		return false;
	}
	
	public boolean update(Categorie categorie) {
		try{
			String strUpdate = "UPDATE CATEGORIE SET NBRMEMBRES = ?,PRENOM_ELEVE = ?,DATE_NAISSANCE = ?,ASSURANCE = ?,PSEUDO = ?,MDP = ?,ID_RESERVATION = ? WHERE PSEUDO = '" + obj.getPseudo() + "' AND MDP = '" + obj.getMdp() + "';";
			PreparedStatement s = this.connect.prepareStatement(strUpdate);
			s.setString(1, obj.getNom());
			s.setString(2, obj.getPrenom());
			s.setDate(3, Date.valueOf(obj.getDate()));
			s.setBoolean(4, obj.getAssurance());
			s.setString(5, obj.getPseudo());
			s.setString(6, obj.getMdp());
			s.setInt(7, obj.getId_reservation());
			s.executeUpdate();
			return true;
		}
		catch(SQLException e){
			e.printStackTrace();
		}
		return false;
	}
	
	public Categorie find(Categorie categorie) {	
		return categorie;
	}
	
	public Categorie find(String nomCategorie) {
		Categorie categorie = new Categorie();
		
		try {
			ResultSet result = this.connect.createStatement().executeQuery("SELECT * FROM CATEGORIE");
			while(result.next()) {
				if(result.getString("SOUSTYPE").equals(nomCategorie)) {
					categorie.setIdCategorie(result.getInt("IDCATEGORIE"));
				}
				else {
					categorie.setIdCategorie(result.getInt("IDCATEGORIE"));
				}
				categorie.setNbrMembres(result.getInt("NBRMEMBRES"));
				categorie.setSupplement(0);
			}
		}
		catch(SQLException e) {
			e.printStackTrace();			
		}
		
		return categorie;
	}
}
